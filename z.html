<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cправочник пользователей</title>
    <script
      src="https://cdn.webix.com/edge/webix.js"
      type="text/javascript"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.webix.com/edge/webix.css"
      type="text/css"
    />
  </head>
  <body>
    <script>
      webix.ui(
          {
            cols: [
              
              {
                view: "sidebar",
                id: "sidebar",
                width: 200,
                
                data: [
                  
                  {
                    id: "users",
                    value: "Пользователи",
                    icon: "mdi mdi-account-group",
                  },
                  { id: "roles", value: "Роли", icon: "mdi mdi-account-key" },
                ],
                on: {
                  onAfterSelect: function (id) {
                    // Обработчик события выбора пункта меню
                    if (id === "users") {
                      // Переключение на таблицу пользователей
                      $$("user_table").show();
                      $$("role_table").hide();
                    } else if (id === "roles") {
                      // Переключение на таблицу ролей
                      $$("role_table").show();
                      $$("user_table").hide();
                    }
                  },
                },
              },
              {
                cells: [
                  
                  {
                    id: "user_table",
                    view: "datatable",

                    autoConfig: true,
                    columns: [
                      { id: "full_name", header: "ФИО", fillspace: true },
                      { id: "login", header: "Логин", fillspace: true },
                      { id: "password", header: "Пароль", fillspace: true },
                      { id: "role_id", header: "Роль", fillspace: true },
                      {
                        id: "is_blocked",
                        header: "Заблокирован",
                        fillspace: true,
                      },
                      {id:"delete",header:"", css: "pointer", template:"{common.writeIcon()}", width:50 },
                      {id:"delete",header:"", css: "pointer", template:"{common.trashIcon()}", width:50 },
                    ],
                  },
                  

                  {
                    id: "role_table",
                    view: "datatable",
                    autoConfig: true,
                    columns: [
                      { id: "role_name", header: "Роли", fillspace: true },
                    ],
                  },
                  
                ],
              },
              
            ],
          },
         );
    </script>
    ,
    <script>
      // Создаем функцию для отправки AJAX запроса и заполнения таблицы данными
      function getUsersAndPopulateTable() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
          if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
              var users = JSON.parse(xhr.responseText);
              // Получаем ссылку на таблицу по id
              var dataTable = $$("user_table");
              // Очищаем текущие данные в таблице
              dataTable.clearAll();
              // Добавляем новые данные в таблицу
              dataTable.parse(users);
            } else {
              console.error("Ошибка при выполнении запроса: " + xhr.status);
            }
          }
        };
        xhr.open("GET", "/php/get_users.php", true);
        xhr.send();
      }

      // Вызываем функцию для получения ролей и заполнения таблицы
      getUsersAndPopulateTable();

      function getRoles() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
          if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
              var roles = JSON.parse(xhr.responseText);
              // Получаем ссылку на таблицу по id
              var dataTable = $$("role_table");
              // Очищаем текущие данные в таблице
              dataTable.clearAll();
              // Добавляем новые данные в таблицу
              dataTable.parse(roles);
            } else {
              console.error("Ошибка при выполнении запроса: " + xhr.status);
            }
          }
        };
        xhr.open("GET", "/php/get_roles.php", true);
        xhr.send();
      }

      // Вызываем функцию для получения ролей и заполнения таблицы
      getRoles();
    </script>
  </body>
</html>
